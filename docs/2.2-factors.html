<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.2 Factors | The {squidSim} R Package Vignette</title>
  <meta name="description" content="This is a vignette for using the squidSim R package." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="2.2 Factors | The {squidSim} R Package Vignette" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a vignette for using the squidSim R package." />
  <meta name="github-repo" content="squid-group/squid" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.2 Factors | The {squidSim} R Package Vignette" />
  
  <meta name="twitter:description" content="This is a vignette for using the squidSim R package." />
  

<meta name="author" content="Joel Pick" />


<meta name="date" content="2022-03-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="2.1-makestr.html"/>
<link rel="next" href="2.3-simulating-predictors-at-different-hierarchical-levels.html"/>
<script src="libs/header-attrs-2.13/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html#intro">The {squidSim} R package<span></span></a>
<ul>
<li><a href="index.html#squid-ethos">SQuID ethos<span></span></a></li>
<li><a href="index.html#why-use-squidsim">Why use squidSim?<span></span></a></li>
<li><a href="index.html#using-the-vignette">Using the vignette<span></span></a></li>
<li><a href="index.html#installation">Installation<span></span></a></li>
<li><a href="index.html#issues-and-bugs">Issues and bugs<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="1-linearmod.html"><a href="1-linearmod.html"><i class="fa fa-check"></i><b>1</b> Simulating population data<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="1.1-simulate_population-function.html"><a href="1.1-simulate_population-function.html"><i class="fa fa-check"></i><b>1.1</b> <code>simulate_population</code> function<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="1.2-simple-linear-model.html"><a href="1.2-simple-linear-model.html"><i class="fa fa-check"></i><b>1.2</b> Simple Linear Model<span></span></a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="1.2-simple-linear-model.html"><a href="1.2-simple-linear-model.html#adding-more-information-about-the-predictors"><i class="fa fa-check"></i><b>1.2.1</b> Adding more information about the predictors<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="1.3-corpred.html"><a href="1.3-corpred.html"><i class="fa fa-check"></i><b>1.3</b> Correlated predictors<span></span></a></li>
<li class="chapter" data-level="1.4" data-path="1.4-interactions.html"><a href="1.4-interactions.html"><i class="fa fa-check"></i><b>1.4</b> Interactions and non-linear effects<span></span></a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="1.4-interactions.html"><a href="1.4-interactions.html#interactions-1"><i class="fa fa-check"></i><b>1.4.1</b> Interactions<span></span></a></li>
<li class="chapter" data-level="1.4.2" data-path="1.4-interactions.html"><a href="1.4-interactions.html#non-linear-effects"><i class="fa fa-check"></i><b>1.4.2</b> Non-linear effects<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="1.5-transformations.html"><a href="1.5-transformations.html"><i class="fa fa-check"></i><b>1.5</b> Transformations<span></span></a></li>
<li class="chapter" data-level="1.6" data-path="1.6-known-predictors.html"><a href="1.6-known-predictors.html"><i class="fa fa-check"></i><b>1.6</b> Known Predictors<span></span></a></li>
<li class="chapter" data-level="1.7" data-path="1.7-nonGaussian.html"><a href="1.7-nonGaussian.html"><i class="fa fa-check"></i><b>1.7</b> Non-Gaussian phenotypes<span></span></a></li>
<li class="chapter" data-level="1.8" data-path="1.8-modeleq.html"><a href="1.8-modeleq.html"><i class="fa fa-check"></i><b>1.8</b> Model equations<span></span></a></li>
<li class="chapter" data-level="1.9" data-path="1.9-npop.html"><a href="1.9-npop.html"><i class="fa fa-check"></i><b>1.9</b> Simulating multiple populations<span></span></a></li>
<li class="chapter" data-level="1.10" data-path="1.10-parameter-list-summary.html"><a href="1.10-parameter-list-summary.html"><i class="fa fa-check"></i><b>1.10</b> Parameter list summary<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-hierarchical.html"><a href="2-hierarchical.html"><i class="fa fa-check"></i><b>2</b> Hierarchical structure<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="2.1-makestr.html"><a href="2.1-makestr.html"><i class="fa fa-check"></i><b>2.1</b> Making a hierarchical structure<span></span></a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="2.1-makestr.html"><a href="2.1-makestr.html#single-factor"><i class="fa fa-check"></i><b>2.1.1</b> Single Factor<span></span></a></li>
<li class="chapter" data-level="2.1.2" data-path="2.1-makestr.html"><a href="2.1-makestr.html#nested-factors"><i class="fa fa-check"></i><b>2.1.2</b> Nested factors<span></span></a></li>
<li class="chapter" data-level="2.1.3" data-path="2.1-makestr.html"><a href="2.1-makestr.html#crossed-factors"><i class="fa fa-check"></i><b>2.1.3</b> Crossed factors<span></span></a></li>
<li class="chapter" data-level="2.1.4" data-path="2.1-makestr.html"><a href="2.1-makestr.html#temporal-structure"><i class="fa fa-check"></i><b>2.1.4</b> Temporal structure<span></span></a></li>
<li class="chapter" data-level="2.1.5" data-path="2.1-makestr.html"><a href="2.1-makestr.html#naming-factor-levels"><i class="fa fa-check"></i><b>2.1.5</b> Naming factor levels<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2.2-factors.html"><a href="2.2-factors.html"><i class="fa fa-check"></i><b>2.2</b> Factors<span></span></a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="2.2-factors.html"><a href="2.2-factors.html#fixed-factor-interactions"><i class="fa fa-check"></i><b>2.2.1</b> Fixed Factor Interactions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="2.3-simulating-predictors-at-different-hierarchical-levels.html"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html"><i class="fa fa-check"></i><b>2.3</b> Simulating predictors at different hierarchical levels<span></span></a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="2.3-simulating-predictors-at-different-hierarchical-levels.html"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#simulating-random-effects"><i class="fa fa-check"></i><b>2.3.1</b> Simulating ‘random’ effects<span></span></a></li>
<li class="chapter" data-level="2.3.2" data-path="2.3-simulating-predictors-at-different-hierarchical-levels.html"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#incorporating-existing-data-structures"><i class="fa fa-check"></i><b>2.3.2</b> Incorporating existing data structures<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2.4-randomslopes.html"><a href="2.4-randomslopes.html"><i class="fa fa-check"></i><b>2.4</b> Random slopes<span></span></a></li>
<li class="chapter" data-level="2.5" data-path="2.5-BetweenWithin.html"><a href="2.5-BetweenWithin.html"><i class="fa fa-check"></i><b>2.5</b> Between- and within-group effects<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-multivariate.html"><a href="3-multivariate.html"><i class="fa fa-check"></i><b>3</b> Multi-response Models<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="3.1-one-response-repeatedly-measured-the-other-not.html"><a href="3.1-one-response-repeatedly-measured-the-other-not.html"><i class="fa fa-check"></i><b>3.1</b> One response repeatedly measured, the other not<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="3.2-different-distributions.html"><a href="3.2-different-distributions.html"><i class="fa fa-check"></i><b>3.2</b> Different distributions<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="3.3-multivariate-random-slopes.html"><a href="3.3-multivariate-random-slopes.html"><i class="fa fa-check"></i><b>3.3</b> Multivariate Random Slopes<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-animal.html"><a href="4-animal.html"><i class="fa fa-check"></i><b>4</b> Genetic effects<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="4.1-va.html"><a href="4.1-va.html"><i class="fa fa-check"></i><b>4.1</b> Additive genetics effects<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="4.2-multivariate-genetic-effects.html"><a href="4.2-multivariate-genetic-effects.html"><i class="fa fa-check"></i><b>4.2</b> Multivariate genetic effects<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="4.3-sex-specific-genetic-variance-and-inter-sexual-genetic-correlations.html"><a href="4.3-sex-specific-genetic-variance-and-inter-sexual-genetic-correlations.html"><i class="fa fa-check"></i><b>4.3</b> Sex specific genetic variance and inter-sexual genetic correlations<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="4.4-gxe.html"><a href="4.4-gxe.html"><i class="fa fa-check"></i><b>4.4</b> GxE<span></span></a></li>
<li class="chapter" data-level="4.5" data-path="4.5-indirect-genetic-effects.html"><a href="4.5-indirect-genetic-effects.html"><i class="fa fa-check"></i><b>4.5</b> Indirect Genetic Effects<span></span></a></li>
<li class="chapter" data-level="4.6" data-path="4.6-dominance.html"><a href="4.6-dominance.html"><i class="fa fa-check"></i><b>4.6</b> Dominance<span></span></a></li>
<li class="chapter" data-level="4.7" data-path="4.7-inbreeding-depression.html"><a href="4.7-inbreeding-depression.html"><i class="fa fa-check"></i><b>4.7</b> Inbreeding depression<span></span></a></li>
<li class="chapter" data-level="4.8" data-path="4.8-genetic-groups.html"><a href="4.8-genetic-groups.html"><i class="fa fa-check"></i><b>4.8</b> Genetic Groups<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-phylogenetic.html"><a href="5-phylogenetic.html"><i class="fa fa-check"></i><b>5</b> Phylogenetic Effects<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="5.1-brownian-motion.html"><a href="5.1-brownian-motion.html"><i class="fa fa-check"></i><b>5.1</b> Brownian motion<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="5.2-ornsteinuhlenbeck-process.html"><a href="5.2-ornsteinuhlenbeck-process.html"><i class="fa fa-check"></i><b>5.2</b> Ornstein–Uhlenbeck Process<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-temporal-and-spatial-effects.html"><a href="6-temporal-and-spatial-effects.html"><i class="fa fa-check"></i><b>6</b> Temporal and Spatial Effects<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="6.1-simple-temporal-effects.html"><a href="6.1-simple-temporal-effects.html"><i class="fa fa-check"></i><b>6.1</b> Simple Temporal Effects<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="6.2-cyclical-temporal-effects.html"><a href="6.2-cyclical-temporal-effects.html"><i class="fa fa-check"></i><b>6.2</b> Cyclical Temporal Effects<span></span></a></li>
<li class="chapter" data-level="6.3" data-path="6.3-temporalauto.html"><a href="6.3-temporalauto.html"><i class="fa fa-check"></i><b>6.3</b> Temporal Autocorrelation<span></span></a></li>
<li class="chapter" data-level="6.4" data-path="6.4-spatialauto.html"><a href="6.4-spatialauto.html"><i class="fa fa-check"></i><b>6.4</b> Spatial Autocorrelation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-sampling.html"><a href="7-sampling.html"><i class="fa fa-check"></i><b>7</b> Sampling<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="7.1-nested.html"><a href="7.1-nested.html"><i class="fa fa-check"></i><b>7.1</b> Nested<span></span></a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="7.1-nested.html"><a href="7.1-nested.html#worked-example-1"><i class="fa fa-check"></i><b>7.1.1</b> Worked example 1<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="7.2-missing-data.html"><a href="7.2-missing-data.html"><i class="fa fa-check"></i><b>7.2</b> Missing data<span></span></a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="7.2-missing-data.html"><a href="7.2-missing-data.html#mcar"><i class="fa fa-check"></i><b>7.2.1</b> MCAR<span></span></a></li>
<li class="chapter" data-level="7.2.2" data-path="7.2-missing-data.html"><a href="7.2-missing-data.html#mar"><i class="fa fa-check"></i><b>7.2.2</b> MAR<span></span></a></li>
<li class="chapter" data-level="7.2.3" data-path="7.2-missing-data.html"><a href="7.2-missing-data.html#mnar"><i class="fa fa-check"></i><b>7.2.3</b> MNAR<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="7.3-temporal-sampling.html"><a href="7.3-temporal-sampling.html"><i class="fa fa-check"></i><b>7.3</b> Temporal Sampling<span></span></a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The {squidSim} R Package Vignette</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="factors" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Factors<a href="2.2-factors.html#factors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the first sections, we just simulated continuous predictors, varying at the level of the observation. However, we may want to simulate factors with known or <em>fixed</em> effects (i.e. not variables drawn randomly from a particular distribution) at different levels, such as sex or treatment effects.</p>
<p>The first thing we want to do is specify a simple data structure, for example 20 observations for each of two sexes:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="2.2-factors.html#cb95-1" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="fu">make_structure</span>(<span class="at">structure=</span><span class="st">&quot;sex(2)&quot;</span>, <span class="at">repeat_obs=</span><span class="dv">100</span>,  <span class="at">level_names=</span><span class="fu">list</span>(<span class="at">sex=</span><span class="fu">c</span>(<span class="st">&quot;female&quot;</span>,<span class="st">&quot;male&quot;</span>)))</span></code></pre></div>
<p>Then we feed this data structure into the <code>simulate_population()</code> function using the <code>data_structure</code> argument. Note that we no longer need to specify the sample size (<code>n</code>), as this is taken from the number of rows in the data_structure.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="2.2-factors.html#cb96-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-2"><a href="2.2-factors.html#cb96-2" aria-hidden="true" tabindex="-1"></a>squid_data <span class="ot">&lt;-</span> <span class="fu">simulate_population</span>(</span>
<span id="cb96-3"><a href="2.2-factors.html#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_structure =</span> ds,</span>
<span id="cb96-4"><a href="2.2-factors.html#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> ...</span>
<span id="cb96-5"><a href="2.2-factors.html#cb96-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>In order to tell the parameter list we have effects that vary at different hierarchical levels, we can create additional slots in the parameter list for the grouping factors, so now it will look something like:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="2.2-factors.html#cb97-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-2"><a href="2.2-factors.html#cb97-2" aria-hidden="true" tabindex="-1"></a>squid_data <span class="ot">&lt;-</span> <span class="fu">simulate_population</span>(</span>
<span id="cb97-3"><a href="2.2-factors.html#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_structure =</span> ds,</span>
<span id="cb97-4"><a href="2.2-factors.html#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> <span class="fu">list</span>(</span>
<span id="cb97-5"><a href="2.2-factors.html#cb97-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">intercept =</span> ...,</span>
<span id="cb97-6"><a href="2.2-factors.html#cb97-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sex =</span> <span class="fu">list</span>(</span>
<span id="cb97-7"><a href="2.2-factors.html#cb97-7" aria-hidden="true" tabindex="-1"></a>      ...</span>
<span id="cb97-8"><a href="2.2-factors.html#cb97-8" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb97-9"><a href="2.2-factors.html#cb97-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">observation =</span> <span class="fu">list</span>(</span>
<span id="cb97-10"><a href="2.2-factors.html#cb97-10" aria-hidden="true" tabindex="-1"></a>      ...</span>
<span id="cb97-11"><a href="2.2-factors.html#cb97-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb97-12"><a href="2.2-factors.html#cb97-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">residual =</span> <span class="fu">list</span>(</span>
<span id="cb97-13"><a href="2.2-factors.html#cb97-13" aria-hidden="true" tabindex="-1"></a>      ...</span>
<span id="cb97-14"><a href="2.2-factors.html#cb97-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb97-15"><a href="2.2-factors.html#cb97-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb97-16"><a href="2.2-factors.html#cb97-16" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The names in the parameter list that relate to the different grouping factors either need to match the name in the data structure exactly (as above) or a ‘group’ argument needs to be given e.g.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="2.2-factors.html#cb98-1" aria-hidden="true" tabindex="-1"></a>squid_data <span class="ot">&lt;-</span> <span class="fu">simulate_population</span>(</span>
<span id="cb98-2"><a href="2.2-factors.html#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_structure =</span> ds,</span>
<span id="cb98-3"><a href="2.2-factors.html#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> <span class="fu">list</span>(</span>
<span id="cb98-4"><a href="2.2-factors.html#cb98-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">intercept =</span> ...,</span>
<span id="cb98-5"><a href="2.2-factors.html#cb98-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">anything =</span> <span class="fu">list</span>(</span>
<span id="cb98-6"><a href="2.2-factors.html#cb98-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">group=</span><span class="st">&quot;sex,&quot;</span></span>
<span id="cb98-7"><a href="2.2-factors.html#cb98-7" aria-hidden="true" tabindex="-1"></a>      ...</span>
<span id="cb98-8"><a href="2.2-factors.html#cb98-8" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb98-9"><a href="2.2-factors.html#cb98-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">observation =</span> <span class="fu">list</span>(</span>
<span id="cb98-10"><a href="2.2-factors.html#cb98-10" aria-hidden="true" tabindex="-1"></a>      ...</span>
<span id="cb98-11"><a href="2.2-factors.html#cb98-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb98-12"><a href="2.2-factors.html#cb98-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">residual =</span> <span class="fu">list</span>(</span>
<span id="cb98-13"><a href="2.2-factors.html#cb98-13" aria-hidden="true" tabindex="-1"></a>      ...</span>
<span id="cb98-14"><a href="2.2-factors.html#cb98-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb98-15"><a href="2.2-factors.html#cb98-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb98-16"><a href="2.2-factors.html#cb98-16" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>We then need to tell the parameters list that we have fixed effects for this grouping factor, in other words we know the difference in body size between the sexes is 0.5, for example. To do this we specify <code>fixed = TRUE</code>.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="2.2-factors.html#cb99-1" aria-hidden="true" tabindex="-1"></a>squid_data <span class="ot">&lt;-</span> <span class="fu">simulate_population</span>(</span>
<span id="cb99-2"><a href="2.2-factors.html#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_structure =</span> ds,</span>
<span id="cb99-3"><a href="2.2-factors.html#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> <span class="fu">list</span>(</span>
<span id="cb99-4"><a href="2.2-factors.html#cb99-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">intercept =</span> ...,</span>
<span id="cb99-5"><a href="2.2-factors.html#cb99-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">anything =</span> <span class="fu">list</span>(</span>
<span id="cb99-6"><a href="2.2-factors.html#cb99-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">group=</span><span class="st">&quot;sex,&quot;</span></span>
<span id="cb99-7"><a href="2.2-factors.html#cb99-7" aria-hidden="true" tabindex="-1"></a>      ...</span>
<span id="cb99-8"><a href="2.2-factors.html#cb99-8" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb99-9"><a href="2.2-factors.html#cb99-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">observation =</span> <span class="fu">list</span>(</span>
<span id="cb99-10"><a href="2.2-factors.html#cb99-10" aria-hidden="true" tabindex="-1"></a>      ...</span>
<span id="cb99-11"><a href="2.2-factors.html#cb99-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb99-12"><a href="2.2-factors.html#cb99-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">residual =</span> <span class="fu">list</span>(</span>
<span id="cb99-13"><a href="2.2-factors.html#cb99-13" aria-hidden="true" tabindex="-1"></a>      ...</span>
<span id="cb99-14"><a href="2.2-factors.html#cb99-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb99-15"><a href="2.2-factors.html#cb99-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb99-16"><a href="2.2-factors.html#cb99-16" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>We can then give a beta for all the different levels of that group. Note that there are two ways to specify this, as there also is in linear models in R. First, we can specify an intercept, and contrasts, equivalent to the output of <code>lm(body_mass~sex)</code>, which involves specifying the beta for the first level as 0 to make it the baseline level (or any other level that you would like to be the baseline).</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="2.2-factors.html#cb100-1" aria-hidden="true" tabindex="-1"></a>squid_data <span class="ot">&lt;-</span> <span class="fu">simulate_population</span>(</span>
<span id="cb100-2"><a href="2.2-factors.html#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_structure =</span> ds,</span>
<span id="cb100-3"><a href="2.2-factors.html#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> <span class="fu">list</span>(</span>
<span id="cb100-4"><a href="2.2-factors.html#cb100-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">intercept=</span> <span class="dv">10</span>,</span>
<span id="cb100-5"><a href="2.2-factors.html#cb100-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sex=</span><span class="fu">list</span>(</span>
<span id="cb100-6"><a href="2.2-factors.html#cb100-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">fixed=</span><span class="cn">TRUE</span>,</span>
<span id="cb100-7"><a href="2.2-factors.html#cb100-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">beta=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>)</span>
<span id="cb100-8"><a href="2.2-factors.html#cb100-8" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb100-9"><a href="2.2-factors.html#cb100-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">residual =</span> <span class="fu">list</span>(</span>
<span id="cb100-10"><a href="2.2-factors.html#cb100-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">vcov =</span> <span class="fl">0.5</span></span>
<span id="cb100-11"><a href="2.2-factors.html#cb100-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb100-12"><a href="2.2-factors.html#cb100-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb100-13"><a href="2.2-factors.html#cb100-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb100-14"><a href="2.2-factors.html#cb100-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-15"><a href="2.2-factors.html#cb100-15" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">get_population_data</span>(squid_data)</span>
<span id="cb100-16"><a href="2.2-factors.html#cb100-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-17"><a href="2.2-factors.html#cb100-17" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>( y <span class="sc">~</span> <span class="fu">factor</span>(sex), data)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="2.2-factors.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>( y <span class="sc">~</span> <span class="fu">factor</span>(sex), data)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ factor(sex), data = data)
## 
## Coefficients:
##     (Intercept)  factor(sex)male  
##         10.0557           0.5553</code></pre>
<p>Alternately, we can specify no intercept (which defaults to 0), and the means for the two levels as betas( equivalent to <code>lm(body_mass~0+sex)</code>):</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="2.2-factors.html#cb103-1" aria-hidden="true" tabindex="-1"></a>squid_data <span class="ot">&lt;-</span> <span class="fu">simulate_population</span>(</span>
<span id="cb103-2"><a href="2.2-factors.html#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_structure =</span> ds,</span>
<span id="cb103-3"><a href="2.2-factors.html#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> <span class="fu">list</span>(</span>
<span id="cb103-4"><a href="2.2-factors.html#cb103-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sex=</span><span class="fu">list</span>(</span>
<span id="cb103-5"><a href="2.2-factors.html#cb103-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">fixed=</span><span class="cn">TRUE</span>,</span>
<span id="cb103-6"><a href="2.2-factors.html#cb103-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">beta=</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="fl">10.5</span>)</span>
<span id="cb103-7"><a href="2.2-factors.html#cb103-7" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb103-8"><a href="2.2-factors.html#cb103-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">residual =</span> <span class="fu">list</span>(</span>
<span id="cb103-9"><a href="2.2-factors.html#cb103-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">vcov =</span> <span class="fl">0.5</span></span>
<span id="cb103-10"><a href="2.2-factors.html#cb103-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb103-11"><a href="2.2-factors.html#cb103-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb103-12"><a href="2.2-factors.html#cb103-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb103-13"><a href="2.2-factors.html#cb103-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-14"><a href="2.2-factors.html#cb103-14" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">get_population_data</span>(squid_data)</span>
<span id="cb103-15"><a href="2.2-factors.html#cb103-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-16"><a href="2.2-factors.html#cb103-16" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>( y <span class="sc">~</span> <span class="fu">factor</span>(sex), data)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="2.2-factors.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>( y <span class="sc">~</span> <span class="fu">factor</span>(sex), data)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ factor(sex), data = data)
## 
## Coefficients:
##     (Intercept)  factor(sex)male  
##         10.0187           0.4616</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="2.2-factors.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>( y <span class="sc">~</span> <span class="dv">0</span><span class="sc">+</span><span class="fu">factor</span>(sex), data)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ 0 + factor(sex), data = data)
## 
## Coefficients:
## factor(sex)female    factor(sex)male  
##             10.02              10.48</code></pre>
<p>We would recommend the former methods, as this makes things clearer if other factors are simulated.</p>
<p>Finally We can also name the levels:
THIS SECTION NEEDS TO BE COMPLETED AS THERE IS A POTENTIAL BUG HERE</p>
<p>Lets take the example of sex. Factors can be thought of as a hierarchical structure. First we can create a data structure using the</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="2.2-factors.html#cb108-1" aria-hidden="true" tabindex="-1"></a>squid_data <span class="ot">&lt;-</span> <span class="fu">simulate_population</span>(</span>
<span id="cb108-2"><a href="2.2-factors.html#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_structure =</span> <span class="fu">make_structure</span>(<span class="at">structure =</span> <span class="st">&quot;sex(2)/individual(500)&quot;</span>, <span class="at">repeat_obs=</span><span class="dv">2</span>),</span>
<span id="cb108-3"><a href="2.2-factors.html#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> <span class="fu">list</span>(</span>
<span id="cb108-4"><a href="2.2-factors.html#cb108-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">intercept=</span> <span class="dv">10</span>,</span>
<span id="cb108-5"><a href="2.2-factors.html#cb108-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sex=</span><span class="fu">list</span>(</span>
<span id="cb108-6"><a href="2.2-factors.html#cb108-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">fixed=</span><span class="cn">TRUE</span>,</span>
<span id="cb108-7"><a href="2.2-factors.html#cb108-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">names=</span><span class="fu">c</span>(<span class="st">&quot;female&quot;</span>,<span class="st">&quot;male&quot;</span>),</span>
<span id="cb108-8"><a href="2.2-factors.html#cb108-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">beta=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>)</span>
<span id="cb108-9"><a href="2.2-factors.html#cb108-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb108-10"><a href="2.2-factors.html#cb108-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">residual =</span> <span class="fu">list</span>(</span>
<span id="cb108-11"><a href="2.2-factors.html#cb108-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">vcov =</span> <span class="fl">0.5</span></span>
<span id="cb108-12"><a href="2.2-factors.html#cb108-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb108-13"><a href="2.2-factors.html#cb108-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb108-14"><a href="2.2-factors.html#cb108-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb108-15"><a href="2.2-factors.html#cb108-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-16"><a href="2.2-factors.html#cb108-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-17"><a href="2.2-factors.html#cb108-17" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">get_population_data</span>(squid_data)</span>
<span id="cb108-18"><a href="2.2-factors.html#cb108-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-19"><a href="2.2-factors.html#cb108-19" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>( y <span class="sc">~</span> <span class="fu">factor</span>(sex), data)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-37-1.png" width="576" /></p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="2.2-factors.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>( y <span class="sc">~</span> <span class="fu">factor</span>(sex), data)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ factor(sex), data = data)
## 
## Coefficients:
##  (Intercept)  factor(sex)2  
##       9.9833        0.5251</code></pre>
<div id="fixed-factor-interactions" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Fixed Factor Interactions<a href="2.2-factors.html#fixed-factor-interactions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We might want to simulate an interaction between a continuous predictor and a factor, for example the effect of the environment varying between two sexes. Specifying this using <code>simulate_population()</code> is similar to interactions between two continuous predictors that we have previously encountered (Section <a href="1.4-interactions.html#interactions">1.4</a>). In the <code>interaction</code> part of the parameter list, we now specify the contrasts between the slopes for environment, using the names that we have assigned the different levels. In the simulation below, males are larger, and have a larger environment slope:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="2.2-factors.html#cb111-1" aria-hidden="true" tabindex="-1"></a>squid_data <span class="ot">&lt;-</span> <span class="fu">simulate_population</span>(</span>
<span id="cb111-2"><a href="2.2-factors.html#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_structure =</span> <span class="fu">make_structure</span>(<span class="at">structure =</span> <span class="st">&quot;sex(2)&quot;</span>, <span class="at">repeat_obs=</span><span class="dv">1000</span>),</span>
<span id="cb111-3"><a href="2.2-factors.html#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> <span class="fu">list</span>(</span>
<span id="cb111-4"><a href="2.2-factors.html#cb111-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">intercept=</span><span class="dv">10</span>,</span>
<span id="cb111-5"><a href="2.2-factors.html#cb111-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sex=</span><span class="fu">list</span>(</span>
<span id="cb111-6"><a href="2.2-factors.html#cb111-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">fixed=</span><span class="cn">TRUE</span>,</span>
<span id="cb111-7"><a href="2.2-factors.html#cb111-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">names=</span><span class="fu">c</span>(<span class="st">&quot;female&quot;</span>,<span class="st">&quot;male&quot;</span>),</span>
<span id="cb111-8"><a href="2.2-factors.html#cb111-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">beta=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>)</span>
<span id="cb111-9"><a href="2.2-factors.html#cb111-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb111-10"><a href="2.2-factors.html#cb111-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">observation=</span> <span class="fu">list</span>(</span>
<span id="cb111-11"><a href="2.2-factors.html#cb111-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">names =</span> <span class="fu">c</span>(<span class="st">&quot;environment&quot;</span>),</span>
<span id="cb111-12"><a href="2.2-factors.html#cb111-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">beta =</span><span class="fu">c</span>(<span class="fl">0.2</span>)</span>
<span id="cb111-13"><a href="2.2-factors.html#cb111-13" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb111-14"><a href="2.2-factors.html#cb111-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">interactions =</span> <span class="fu">list</span>(</span>
<span id="cb111-15"><a href="2.2-factors.html#cb111-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">names=</span><span class="fu">c</span>(<span class="st">&quot;environment:male&quot;</span>),</span>
<span id="cb111-16"><a href="2.2-factors.html#cb111-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">beta =</span> <span class="fl">0.4</span></span>
<span id="cb111-17"><a href="2.2-factors.html#cb111-17" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb111-18"><a href="2.2-factors.html#cb111-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">residual =</span> <span class="fu">list</span>(</span>
<span id="cb111-19"><a href="2.2-factors.html#cb111-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">names=</span><span class="st">&quot;residual&quot;</span>,</span>
<span id="cb111-20"><a href="2.2-factors.html#cb111-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">vcov =</span> <span class="fl">0.1</span></span>
<span id="cb111-21"><a href="2.2-factors.html#cb111-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb111-22"><a href="2.2-factors.html#cb111-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb111-23"><a href="2.2-factors.html#cb111-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb111-24"><a href="2.2-factors.html#cb111-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-25"><a href="2.2-factors.html#cb111-25" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">get_population_data</span>(squid_data)</span>
<span id="cb111-26"><a href="2.2-factors.html#cb111-26" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code></pre></div>
<pre><code>##            y female male environment   residual environment:male sex squid_pop
## 1: 10.019434      1    0  0.41206427 -0.0629791                0   1         1
## 2: 10.540281      1    0  0.32692691  0.4748954                0   1         1
## 3: 10.049829      1    0  0.97512302 -0.1451960                0   1         1
## 4:  9.722917      1    0  0.42586256 -0.3622560                0   1         1
## 5:  9.757621      1    0 -0.20123633 -0.2021317                0   1         1
## 6:  9.682432      1    0 -0.09276156 -0.2990161                0   1         1</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="2.2-factors.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y<span class="sc">~</span>environment,data, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">col=</span>scales<span class="sc">::</span><span class="fu">alpha</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="fl">0.5</span>)[<span class="fu">factor</span>(data<span class="sc">$</span>sex)])</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-38-1.png" width="576" /></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="2.2-factors.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>( y <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fu">factor</span>(sex)<span class="sc">*</span>environment, data)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ 0 + factor(sex) * environment, data = data)
## 
## Coefficients:
##             factor(sex)1              factor(sex)2               environment  
##                  10.0114                   10.5115                    0.1852  
## factor(sex)2:environment  
##                   0.4106</code></pre>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="2.1-makestr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="2.3-simulating-predictors-at-different-hierarchical-levels.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
